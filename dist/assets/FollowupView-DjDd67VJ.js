import{d as b,c as v,b as e,h as C,t as w,n as F,f as p,e as f,i as d,F as I,m as A,k as U,s as T,g as y,v as M,x as h,r as c,y as S,w as B,z as j,u as E,j as L,l as R}from"./index-J5MGib1M.js";import{B as _,_ as q}from"./AppLayout.vue_vue_type_script_setup_true_lang-CJ_uuTcT.js";import{C as N}from"./clock-D8WO29_3.js";import{c as P}from"./createLucideIcon-BGKXoyUX.js";import{T as H,P as G}from"./trash-2-BdcdKQat.js";/**
 * @license lucide-vue-next v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=P("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),K=(n,a)=>new Date(new Date(n).getTime()+a*60*1e3).toLocaleString("ru-RU",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),D=(n,a)=>{const t=new Date,i=new Date(new Date(n).getTime()+a*60*1e3);if(i<t)return{text:"Просрочено",color:"text-red-600 bg-red-50"};const s=(i.getTime()-t.getTime())/(1e3*60*60);return s<1?{text:"Скоро",color:"text-orange-600 bg-orange-50"}:s<24?{text:"Сегодня",color:"text-blue-600 bg-blue-50"}:{text:"Запланировано",color:"text-slate-600 bg-slate-50"}},O={class:"p-6 hover:bg-slate-50 transition-colors"},Q={class:"flex items-start justify-between"},W={class:"flex-1"},X={class:"flex items-center gap-3 mb-2"},Y={class:"font-medium text-slate-900"},Z={key:0,class:"px-2 py-1 text-xs rounded-lg bg-blue-50 text-blue-700"},ee={class:"flex items-center gap-2 text-sm text-slate-600"},te={class:"flex items-center gap-2"},le=b({__name:"FollowupItem",props:{followup:{}},emits:["edit","remove"],setup(n){return(a,t)=>(d(),v("div",O,[e("div",Q,[e("div",W,[e("div",X,[e("h3",Y,w(n.followup.text),1),n.followup.isDefault?(d(),v("span",Z," По умолчанию ")):C("",!0),e("span",{class:F(["px-2 py-1 text-xs rounded-lg",p(D)(n.followup.createdAt,n.followup.intervalMinutes).color])},w(p(D)(n.followup.createdAt,n.followup.intervalMinutes).text),3)]),e("div",ee,[f(p(N),{size:16}),e("span",null,w(p(K)(n.followup.createdAt,n.followup.intervalMinutes))+" (через "+w(n.followup.intervalMinutes)+" мин)",1)])]),e("div",te,[e("button",{onClick:t[0]||(t[0]=i=>a.$emit("edit",n.followup)),class:"p-2 text-slate-600 hover:bg-slate-100 rounded-lg transition-colors"},[f(p(J),{size:18})]),e("button",{onClick:t[1]||(t[1]=i=>a.$emit("remove",n.followup.id)),class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors"},[f(p(H),{size:18})])])])]))}}),se={class:"bg-white rounded-2xl shadow-sm border border-slate-200"},oe={key:0,class:"text-center py-16"},ne={class:"w-20 h-20 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4"},ae={key:1,class:"divide-y divide-slate-200"},ie=b({__name:"FollowupList",props:{followups:{}},emits:["edit","remove"],setup(n){return(a,t)=>(d(),v("div",se,[n.followups.length===0?(d(),v("div",oe,[e("div",ne,[f(p(_),{size:32,class:"text-slate-400"})]),t[2]||(t[2]=e("h3",{class:"text-lg font-medium text-slate-900 mb-2"},"Нет напоминаний",-1)),t[3]||(t[3]=e("p",{class:"text-sm text-slate-600"},"Создайте первое напоминание",-1))])):(d(),v("div",ae,[(d(!0),v(I,null,A(n.followups,i=>(d(),U(le,{key:i.id,followup:i,onEdit:t[0]||(t[0]=s=>a.$emit("edit",s)),onRemove:t[1]||(t[1]=s=>a.$emit("remove",s))},null,8,["followup"]))),128))]))]))}}),ue={class:"grid grid-cols-5 gap-2 mb-3"},re=["onClick"],de=b({__name:"IntervalSelector",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(n){const a=T(n,"modelValue"),t=[5,10,15,30,60];return(i,s)=>(d(),v("div",null,[s[1]||(s[1]=e("label",{class:"block text-sm font-medium text-slate-700 mb-3"},"Время срабатывания",-1)),s[2]||(s[2]=e("div",{class:"mb-3 text-xs text-slate-600"},"Выберите интервал (от текущего момента):",-1)),e("div",ue,[(d(),v(I,null,A(t,u=>e("button",{key:u,type:"button",onClick:m=>a.value=u,class:F(["px-3 py-2 rounded-lg text-sm font-medium transition-colors",a.value===u?"bg-slate-900 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"])},w(u)+" мин ",11,re)),64))]),s[3]||(s[3]=e("div",{class:"text-xs text-slate-600 mb-2"},"Или укажите свое значение (в минутах):",-1)),y(e("input",{"onUpdate:modelValue":s[0]||(s[0]=u=>a.value=u),type:"number",min:"1",placeholder:"Количество минут",class:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent"},null,512),[[M,a.value,void 0,{number:!0}]])]))}}),me={class:"bg-white rounded-2xl max-w-md w-full p-6"},ve={class:"space-y-4 mb-6"},fe={class:"flex items-center gap-3 cursor-pointer"},xe={class:"flex gap-3"},pe=["disabled"],ce=b({__name:"AddFollowupModal",props:{modelValue:{type:Boolean,required:!0},modelModifiers:{}},emits:h(["add"],["update:modelValue"]),setup(n,{emit:a}){const t=T(n,"modelValue"),i=a,s=c("Уточни у клиента актуальность вопроса, учитывая предыдущий контекст диалога"),u=c(5),m=c(!1),g=()=>{s.value&&(i("add",s.value,u.value,m.value),t.value=!1)};return(V,l)=>t.value?(d(),v("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:l[4]||(l[4]=B(o=>t.value=!1,["self"]))},[e("div",me,[l[7]||(l[7]=e("h2",{class:"text-xl font-semibold text-slate-900 mb-4"},"Добавить напоминание",-1)),e("div",ve,[e("div",null,[l[5]||(l[5]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Текст напоминания",-1)),y(e("textarea",{"onUpdate:modelValue":l[0]||(l[0]=o=>s.value=o),placeholder:"Введите текст напоминания",rows:"3",class:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent resize-none"},null,512),[[M,s.value]])]),f(de,{modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=o=>u.value=o)},null,8,["modelValue"]),e("label",fe,[y(e("input",{"onUpdate:modelValue":l[2]||(l[2]=o=>m.value=o),type:"checkbox",class:"w-5 h-5 text-slate-900 bg-slate-50 border-slate-300 rounded focus:ring-2 focus:ring-slate-900"},null,512),[[S,m.value]]),l[6]||(l[6]=e("span",{class:"text-sm text-slate-700"},"Использовать контекст чата по умолчанию",-1))])]),e("div",xe,[e("button",{onClick:l[3]||(l[3]=o=>t.value=!1),class:"flex-1 px-4 py-3 bg-slate-100 text-slate-700 rounded-xl hover:bg-slate-200 transition-colors"}," Отмена "),e("button",{onClick:g,disabled:!s.value,class:"flex-1 px-4 py-3 bg-slate-900 text-white rounded-xl hover:bg-slate-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," Добавить ",8,pe)])])])):C("",!0)}}),be={class:"bg-white rounded-2xl max-w-md w-full p-6"},ge={class:"space-y-4 mb-6"},we={class:"flex gap-3"},ye=["disabled"],$e=b({__name:"EditFollowupModal",props:h({followupId:{},initialText:{},initialIntervalMinutes:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:h(["save"],["update:modelValue"]),setup(n,{emit:a}){const t=T(n,"modelValue"),i=n,s=a,u=c(""),m=c(5);j(()=>[i.followupId,i.initialText,i.initialIntervalMinutes],()=>{i.followupId&&(u.value=i.initialText||"",m.value=i.initialIntervalMinutes||5)},{immediate:!0});const g=()=>{!i.followupId||!u.value||(s("save",i.followupId,u.value,m.value),t.value=!1)};return(V,l)=>t.value?(d(),v("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:l[3]||(l[3]=B(o=>t.value=!1,["self"]))},[e("div",be,[l[6]||(l[6]=e("h2",{class:"text-xl font-semibold text-slate-900 mb-4"},"Редактировать напоминание",-1)),e("div",ge,[e("div",null,[l[4]||(l[4]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Текст напоминания",-1)),y(e("textarea",{"onUpdate:modelValue":l[0]||(l[0]=o=>u.value=o),placeholder:"Введите текст напоминания",rows:"3",class:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent resize-none"},null,512),[[M,u.value]])]),e("div",null,[l[5]||(l[5]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Интервал (в минутах)",-1)),y(e("input",{"onUpdate:modelValue":l[1]||(l[1]=o=>m.value=o),type:"number",min:"1",placeholder:"Количество минут",class:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent"},null,512),[[M,m.value,void 0,{number:!0}]])])]),e("div",we,[e("button",{onClick:l[2]||(l[2]=o=>t.value=!1),class:"flex-1 px-4 py-3 bg-slate-100 text-slate-700 rounded-xl hover:bg-slate-200 transition-colors"}," Отмена "),e("button",{onClick:g,disabled:!u.value,class:"flex-1 px-4 py-3 bg-slate-900 text-white rounded-xl hover:bg-slate-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," Сохранить ",8,ye)])])])):C("",!0)}}),ke={class:"p-8"},Me={class:"flex items-center justify-between mb-8"},De=b({__name:"FollowupView",setup(n){const a=E(),t=c(!1),i=c(!1),s=c(null),u=L(()=>[...a.followups.value].sort((o,r)=>{const x=new Date(o.createdAt).getTime()+o.intervalMinutes*60*1e3,$=new Date(r.createdAt).getTime()+r.intervalMinutes*60*1e3;return x-$})),m=(o,r,x)=>{a.addFollowup(o,r,x)},g=o=>{s.value={id:o.id,text:o.text,intervalMinutes:o.intervalMinutes},i.value=!0},V=(o,r,x)=>{a.updateFollowup(o,r,x),s.value=null},l=o=>{confirm("Вы уверены, что хотите удалить это напоминание?")&&a.removeFollowup(o)};return(o,r)=>(d(),U(q,null,{default:R(()=>{var x,$,z;return[e("div",ke,[e("div",Me,[r[4]||(r[4]=e("div",null,[e("h1",{class:"text-3xl font-semibold text-slate-900 mb-2"},"Напоминания"),e("p",{class:"text-slate-600"},"Управление запланированными напоминаниями")],-1)),e("button",{onClick:r[0]||(r[0]=k=>t.value=!0),class:"flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-xl hover:bg-slate-800 transition-colors"},[f(p(G),{size:20}),r[3]||(r[3]=e("span",null,"Добавить напоминание",-1))])]),f(ie,{followups:u.value,onEdit:g,onRemove:l},null,8,["followups"])]),f(ce,{modelValue:t.value,"onUpdate:modelValue":r[1]||(r[1]=k=>t.value=k),onAdd:m},null,8,["modelValue"]),f($e,{modelValue:i.value,"onUpdate:modelValue":r[2]||(r[2]=k=>i.value=k),"followup-id":(x=s.value)==null?void 0:x.id,"initial-text":($=s.value)==null?void 0:$.text,"initial-interval-minutes":(z=s.value)==null?void 0:z.intervalMinutes,onSave:V},null,8,["modelValue","followup-id","initial-text","initial-interval-minutes"])]}),_:1}))}});export{De as default};
