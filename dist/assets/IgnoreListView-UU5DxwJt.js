import{d as D,u as F,r as x,j as $,k as z,l as T,b as e,c as a,h as p,e as h,f,F as _,m as w,t as i,g as V,v as B,w as M,i as n}from"./index-J5MGib1M.js";import{_ as N,U as S}from"./AppLayout.vue_vue_type_script_setup_true_lang-CJ_uuTcT.js";import{P as A,T as P}from"./trash-2-BdcdKQat.js";import"./createLucideIcon-BGKXoyUX.js";const q={class:"p-8"},E={class:"flex items-center justify-between mb-8"},Q={class:"bg-white rounded-2xl shadow-sm border border-slate-200"},R={key:0,class:"text-center py-16"},X={class:"w-20 h-20 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4"},G={key:1,class:"divide-y divide-slate-200"},H={class:"flex items-center gap-4"},J={class:"w-12 h-12 bg-slate-200 rounded-full flex items-center justify-center"},K={class:"text-slate-600 font-medium"},O={class:"font-medium text-slate-900"},W={class:"text-sm text-slate-500"},Y=["onClick"],Z={class:"bg-white rounded-2xl max-w-md w-full p-6"},ee={class:"mb-6 relative"},te={key:0,class:"absolute z-10 w-full mt-2 bg-white border border-slate-200 rounded-xl shadow-lg max-h-64 overflow-y-auto"},se=["onClick"],oe={class:"flex items-center gap-3"},le={class:"w-10 h-10 bg-slate-200 rounded-full flex items-center justify-center flex-shrink-0"},ne={class:"text-slate-600 font-medium"},ae={class:"flex-1 min-w-0"},ie={class:"font-medium text-slate-900 truncate"},de={class:"text-sm text-slate-500 truncate"},re={key:1,class:"mt-3 p-3 bg-green-50 border border-green-200 rounded-xl"},ce={class:"flex items-center gap-3"},ue={class:"w-10 h-10 bg-green-200 rounded-full flex items-center justify-center"},me={class:"text-green-700 font-medium"},ve={class:"font-medium text-slate-900"},fe={class:"text-sm text-slate-600"},xe={class:"flex gap-3"},pe=["disabled"],ke=D({__name:"IgnoreListView",setup(he){const d=F(),u=x(!1),r=x(""),l=x(null),m=x(!1),c=s=>(s==null?void 0:s.name)||(s==null?void 0:s.username)||(s==null?void 0:s.phone)||"Неизвестно",b=$(()=>{const s=d.users.value.filter(o=>!d.ignoredUsers.value.some(v=>v.userId===o.id));if(!r.value.trim())return s;const t=r.value.toLowerCase().trim();return s.filter(o=>{const v=(o.name||"").toLowerCase(),L=(o.username||"").toLowerCase(),j=(o.phone||"").toLowerCase();return(o.chatId||"").toLowerCase().includes(t)||v.includes(t)||L.includes(t)||j.includes(t)})}),g=s=>{l.value=s,r.value=c(s),m.value=!1},y=()=>{m.value=!0},k=()=>{l.value=null,m.value=!0;const s=d.users.value.find(t=>t.chatId===r.value.trim());s&&g(s)},C=()=>{l.value&&(d.addToIgnoreList(l.value.id),u.value=!1,r.value="",l.value=null,m.value=!1)},I=s=>{d.removeFromIgnoreList(s)},U=s=>new Date(s).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"});return(s,t)=>(n(),z(N,null,{default:T(()=>[e("div",q,[e("div",E,[t[5]||(t[5]=e("div",null,[e("h1",{class:"text-3xl font-semibold text-slate-900 mb-2"},"Лист игнор"),e("p",{class:"text-slate-600"},"Управление черным списком пользователей")],-1)),e("button",{onClick:t[0]||(t[0]=o=>u.value=!0),class:"flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-xl hover:bg-slate-800 transition-colors"},[h(f(A),{size:20}),t[4]||(t[4]=e("span",null,"Добавить в игнор",-1))])]),e("div",Q,[f(d).ignoredUsers.value.length===0?(n(),a("div",R,[e("div",X,[h(f(S),{size:32,class:"text-slate-400"})]),t[6]||(t[6]=e("h3",{class:"text-lg font-medium text-slate-900 mb-2"},"Список пуст",-1)),t[7]||(t[7]=e("p",{class:"text-sm text-slate-600"},"Нет пользователей в черном списке",-1))])):(n(),a("div",G,[(n(!0),a(_,null,w(f(d).ignoredUsers.value,o=>(n(),a("div",{key:o.id,class:"p-6 flex items-center justify-between hover:bg-slate-50 transition-colors"},[e("div",H,[e("div",J,[e("span",K,i(c(o.user)[0].toUpperCase()),1)]),e("div",null,[e("h3",O,i(c(o.user)),1),e("p",W,"Добавлен: "+i(U(o.createdAt)),1)])]),e("button",{onClick:v=>I(o.id),class:"flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors"},[h(f(P),{size:18}),t[8]||(t[8]=e("span",null,"Удалить",-1))],8,Y)]))),128))]))])]),u.value?(n(),a("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:t[3]||(t[3]=M(o=>u.value=!1,["self"]))},[e("div",Z,[t[10]||(t[10]=e("h2",{class:"text-xl font-semibold text-slate-900 mb-4"},"Добавить в игнор",-1)),e("div",ee,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Выберите пользователя",-1)),V(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>r.value=o),type:"text",placeholder:"Введите имя или chat_id",class:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent",onFocus:y,onInput:k},null,544),[[B,r.value]]),m.value&&b.value.length>0?(n(),a("div",te,[(n(!0),a(_,null,w(b.value,o=>(n(),a("div",{key:o.id,onClick:v=>g(o),class:"px-4 py-3 hover:bg-slate-50 cursor-pointer border-b border-slate-100 last:border-b-0"},[e("div",oe,[e("div",le,[e("span",ne,i(c(o)[0].toUpperCase()),1)]),e("div",ae,[e("div",ie,i(c(o)),1),e("div",de,"chat_id: "+i(o.chatId),1)])])],8,se))),128))])):p("",!0),l.value?(n(),a("div",re,[e("div",ce,[e("div",ue,[e("span",me,i(c(l.value)[0].toUpperCase()),1)]),e("div",null,[e("div",ve,i(c(l.value)),1),e("div",fe,"chat_id: "+i(l.value.chatId),1)])])])):p("",!0)]),e("div",xe,[e("button",{onClick:t[2]||(t[2]=o=>u.value=!1),class:"flex-1 px-4 py-3 bg-slate-100 text-slate-700 rounded-xl hover:bg-slate-200 transition-colors"}," Отмена "),e("button",{onClick:C,disabled:!l.value,class:"flex-1 px-4 py-3 bg-slate-900 text-white rounded-xl hover:bg-slate-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," Добавить ",8,pe)])])])):p("",!0)]),_:1}))}});export{ke as default};
