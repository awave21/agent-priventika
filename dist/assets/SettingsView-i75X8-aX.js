import{d as N,u as j,r as p,o as D,k as y,l as I,b as e,c as h,h as C,e as i,f as s,t as f,n as x,C as k,g as z,v as S,i as d}from"./index-J5MGib1M.js";import{_ as B,S as T}from"./AppLayout.vue_vue_type_script_setup_true_lang-CJ_uuTcT.js";import{c as m}from"./createLucideIcon-BGKXoyUX.js";import{C as _}from"./clock-D8WO29_3.js";/**
 * @license lucide-vue-next v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=m("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-vue-next v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=m("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-vue-next v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=m("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-vue-next v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=m("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);/**
 * @license lucide-vue-next v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=m("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-vue-next v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=m("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),q={class:"p-8 max-w-4xl"},E={class:"flex items-center gap-3 mb-8"},H={class:"w-12 h-12 bg-slate-900 rounded-2xl flex items-center justify-center"},J={key:0,class:"mb-6 p-4 bg-emerald-50 border border-emerald-200 rounded-xl flex items-center gap-3"},G={class:"space-y-6"},O={class:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6"},P={class:"flex items-center gap-3 mb-6"},X={class:"space-y-4"},F={class:"flex items-center justify-between p-4 bg-slate-50 rounded-xl"},Q={class:"text-sm text-slate-600 mt-1"},W={class:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6"},Y={class:"flex items-center gap-3 mb-6"},Z={class:"space-y-4"},ee={class:"flex gap-2 mb-4"},te={class:"p-4 bg-blue-50 border border-blue-200 rounded-xl"},se={class:"text-sm text-blue-900"},le={class:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6"},ae={class:"flex items-center gap-3 mb-6"},oe={class:"space-y-4"},ne=["disabled"],re={key:0,class:"p-4 bg-emerald-50 border border-emerald-200 rounded-xl flex items-center gap-3"},ie={key:1,class:"p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3"},de={class:"text-sm text-red-900"},ue={class:"text-red-700"},be={class:"flex justify-end gap-3"},ye=N({__name:"SettingsView",setup(pe){const n=j(),l=p(5),u=p(""),r=p(""),w=p(!1),v=p(!1),o=p("idle"),c=p("");D(()=>{l.value=n.settings.value.botResponseDelayMinutes,u.value=n.settings.value.supabaseUrl,r.value=n.settings.value.supabaseAnonKey});const $=()=>{n.updateSettings({botResponseDelayMinutes:l.value,supabaseUrl:u.value,supabaseAnonKey:r.value}),w.value=!0,setTimeout(()=>{w.value=!1},3e3)},g=b=>{l.value=b},A=async()=>{if(!u.value||!r.value){o.value="error",c.value="Заполните URL и Anon Key";return}v.value=!0,o.value="idle",c.value="";try{const b=u.value.replace(/\/$/,""),t=await fetch(`${b}/rest/v1/`,{method:"GET",headers:{apikey:r.value,Authorization:`Bearer ${r.value}`}});t.ok||t.status===404?o.value="success":(o.value="error",c.value=`Ошибка подключения: ${t.status} ${t.statusText}`)}catch(b){o.value="error",c.value=b instanceof Error?b.message:"Не удалось подключиться к Supabase"}finally{v.value=!1}};return(b,t)=>(d(),y(B,null,{default:I(()=>[e("div",q,[e("div",E,[e("div",H,[i(s(T),{size:24,class:"text-white"})]),t[8]||(t[8]=e("div",null,[e("h1",{class:"text-3xl font-semibold text-slate-900"},"Настройки"),e("p",{class:"text-slate-600"},"Конфигурация системы и интеграций")],-1))]),w.value?(d(),h("div",J,[i(s(M),{size:20,class:"text-emerald-600"}),t[9]||(t[9]=e("span",{class:"text-emerald-900 font-medium"},"Настройки успешно сохранены",-1))])):C("",!0),e("div",G,[e("div",O,[e("div",P,[i(s(R),{size:20,class:"text-slate-600"}),t[10]||(t[10]=e("h2",{class:"text-xl font-semibold text-slate-900"},"Отправка новым пользователям",-1))]),e("div",X,[t[12]||(t[12]=e("p",{class:"text-sm text-slate-600"}," Включите этот режим, чтобы автоматически отправлять приветственные сообщения новым пользователям ",-1)),e("div",F,[e("div",null,[t[11]||(t[11]=e("p",{class:"font-medium text-slate-900"},"Режим отправки новым пользователям",-1)),e("p",Q,f(s(n).settings.value.sentNewUser?"Включен":"Выключен"),1)]),e("button",{onClick:t[0]||(t[0]=a=>s(n).toggleSentNewUser()),class:x(["relative w-14 h-7 rounded-full transition-colors",s(n).settings.value.sentNewUser?"bg-blue-500":"bg-slate-300"])},[e("div",{class:x(["absolute top-0.5 w-6 h-6 bg-white rounded-full transition-all",s(n).settings.value.sentNewUser?"left-7":"left-0.5"])},null,2)],2)]),t[13]||(t[13]=e("div",{class:"p-4 bg-amber-50 border border-amber-200 rounded-xl"},[e("p",{class:"text-sm text-amber-900"},[e("strong",null,"Примечание:"),k(" Это поведение применяется только к пользователям, которые впервые написали в чат ")])],-1))])]),e("div",W,[e("div",Y,[i(s(_),{size:20,class:"text-slate-600"}),t[14]||(t[14]=e("h2",{class:"text-xl font-semibold text-slate-900"},"Задержка ответа бота",-1))]),e("div",Z,[t[19]||(t[19]=e("p",{class:"text-sm text-slate-600"}," Укажите через сколько минут бот может ответить после сообщения пользователя, если уже общается менеджер ",-1)),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-slate-700 mb-3"}," Задержка (в минутах) ",-1)),e("div",ee,[e("button",{type:"button",onClick:t[1]||(t[1]=a=>g(3)),class:x(["px-4 py-2 rounded-lg text-sm font-medium transition-colors",l.value===3?"bg-slate-900 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"])}," 3 мин ",2),e("button",{type:"button",onClick:t[2]||(t[2]=a=>g(5)),class:x(["px-4 py-2 rounded-lg text-sm font-medium transition-colors",l.value===5?"bg-slate-900 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"])}," 5 мин ",2),e("button",{type:"button",onClick:t[3]||(t[3]=a=>g(10)),class:x(["px-4 py-2 rounded-lg text-sm font-medium transition-colors",l.value===10?"bg-slate-900 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"])}," 10 мин ",2),e("button",{type:"button",onClick:t[4]||(t[4]=a=>g(15)),class:x(["px-4 py-2 rounded-lg text-sm font-medium transition-colors",l.value===15?"bg-slate-900 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"])}," 15 мин ",2)]),z(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>l.value=a),type:"number",min:"1",max:"60",placeholder:"Укажите свое значение",class:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent"},null,512),[[S,l.value,void 0,{number:!0}]])]),e("div",te,[e("p",se,[t[16]||(t[16]=e("strong",null,"Текущая настройка:",-1)),t[17]||(t[17]=k(" Бот может ответить через ",-1)),e("strong",null,f(l.value)+" минут",1),t[18]||(t[18]=k(" после последнего сообщения пользователя, если менеджер уже взял чат в работу ",-1))])])])]),e("div",le,[e("div",ae,[i(s(V),{size:20,class:"text-slate-600"}),t[20]||(t[20]=e("h2",{class:"text-xl font-semibold text-slate-900"},"Подключение к Supabase",-1))]),e("div",oe,[t[25]||(t[25]=e("p",{class:"text-sm text-slate-600 mb-4"}," Настройте подключение к вашему проекту Supabase для синхронизации данных ",-1)),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Supabase URL",-1)),z(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>u.value=a),type:"url",placeholder:"https://ваш-проект.supabase.co",class:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent"},null,512),[[S,u.value]])]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"}," Supabase Anon Key ",-1)),z(e("input",{"onUpdate:modelValue":t[7]||(t[7]=a=>r.value=a),type:"password",placeholder:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",class:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent"},null,512),[[S,r.value]])]),e("div",null,[e("button",{type:"button",onClick:A,disabled:v.value||!u.value||!r.value,class:"w-full px-4 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[v.value?(d(),y(s(K),{key:0,size:20,class:"animate-spin"})):o.value==="success"?(d(),y(s(M),{key:1,size:20})):o.value==="error"?(d(),y(s(U),{key:2,size:20})):(d(),y(s(V),{key:3,size:20})),e("span",null,f(v.value?"Проверка...":"Проверить подключение"),1)],8,ne)]),o.value==="success"?(d(),h("div",re,[i(s(M),{size:20,class:"text-emerald-600"}),t[23]||(t[23]=e("span",{class:"text-emerald-900 font-medium"},"Подключение успешно установлено",-1))])):C("",!0),o.value==="error"?(d(),h("div",ie,[i(s(U),{size:20,class:"text-red-600 flex-shrink-0 mt-0.5"}),e("div",de,[t[24]||(t[24]=e("p",{class:"font-medium mb-1"},"Ошибка подключения",-1)),e("p",ue,f(c.value),1)])])):C("",!0),t[26]||(t[26]=e("div",{class:"p-4 bg-amber-50 border border-amber-200 rounded-xl"},[e("p",{class:"text-sm text-amber-900"},[e("strong",null,"Важно:"),k(" Эти данные хранятся локально в памяти приложения. Для постоянного хранения необходимо настроить сохранение в Supabase ")])],-1))])]),e("div",be,[e("button",{onClick:$,class:"flex items-center gap-2 px-6 py-3 bg-slate-900 text-white rounded-xl hover:bg-slate-800 transition-colors"},[i(s(L),{size:20}),t[27]||(t[27]=e("span",null,"Сохранить настройки",-1))])])])])]),_:1}))}});export{ye as default};
